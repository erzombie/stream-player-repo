<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<title>Uma Stats Bar Overlay</title>
<style>
  :root{
    --font:'Roboto',system-ui,-apple-system,'Segoe UI',Arial,sans-serif;
    --numColor:#4a2d00;
    --numShadow:0 1px 2px rgba(0,0,0,.25);
  }
  html,body{margin:0;background:transparent;height:100%}
  #bar{display:flex;gap:4px;align-items:flex-start;justify-content:center;
       height:100vh;pointer-events:none;padding:8px}

  .slot{position:relative;width:200px;height:80px;
        background-size:contain;background-repeat:no-repeat;background-position:center}
  .val{position:absolute;bottom:-8px;left:50%;transform:translateX(-50%);
       font:900 32px/1 var(--font);color:var(--numColor);text-shadow:var(--numShadow)}

  /* chevron anim same as before */
  .chev{position:absolute;left:50%;top:40%;width:60px;
        transform:translate(-50%,-50%);opacity:.6;pointer-events:none}
  @keyframes rise {0%{transform:translate(-50%,-20%) scale(.9);opacity:0}
                   20%{opacity:1}
                   80%{transform:translate(-50%,-160%) scale(1.05);opacity:1}
                   100%{transform:translate(-50%,-200%) scale(1);opacity:0}}
  @keyframes drop {0%{transform:translate(-50%,-80%) scale(.9);opacity:0}
                   20%{opacity:1}
                   80%{transform:translate(-50%,40%) scale(1.05);opacity:1}
                   100%{transform:translate(-50%,80%) scale(1);opacity:0}}
  .animUp{animation:rise 900ms cubic-bezier(.2,.9,.2,1) forwards}
  .animDown{animation:drop 900ms cubic-bezier(.2,.9,.2,1) forwards}

  .pop{animation:pop 400ms ease-out}
  @keyframes pop{0%{transform:translateX(-50%) scale(.9)}
                 60%{transform:translateX(-50%) scale(1.1)}
                 100%{transform:translateX(-50%) scale(1)}}
</style>
</head>
<body>
<div id="bar">
  <div class="slot" id="Speed"><span class="val" id="valSpeed">0</span></div>
  <div class="slot" id="Stamina"><span class="val" id="valStamina">0</span></div>
  <div class="slot" id="Power"><span class="val" id="valPower">0</span></div>
  <div class="slot" id="Guts"><span class="val" id="valGuts">0</span></div>
  <div class="slot" id="Wit"><span class="val" id="valWit">0</span></div>
</div>

<script>
const qs=new URLSearchParams(location.search);

const BARS={
  Speed:"https://erzombie.github.io/stream-player-repo/uma_overlay/bar_speed.png",
  Stamina:"https://erzombie.github.io/stream-player-repo/uma_overlay/bar_stamina.png",
  Power:"https://erzombie.github.io/stream-player-repo/uma_overlay/bar_power.png",
  Guts:"https://erzombie.github.io/stream-player-repo/uma_overlay/bar_guts.png",
  Wit:"https://erzombie.github.io/stream-player-repo/uma_overlay/bar_wit.png"
};
const CHEV_UP="https://erzombie.github.io/stream-player-repo/uma_overlay/uma_pos_chevron.png";
const CHEV_DOWN="https://erzombie.github.io/stream-player-repo/uma_overlay/uma_neg_chevron.png";

const totals={
  Speed:parseInt(qs.get('speed')||'0',10),
  Stamina:parseInt(qs.get('stamina')||'0',10),
  Power:parseInt(qs.get('power')||'0',10),
  Guts:parseInt(qs.get('guts')||'0',10),
  Wit:parseInt(qs.get('wit')||'0',10),
};
const animStat=(qs.get('anim')||'').toLowerCase();
const theme=(qs.get('theme')||'up').toLowerCase();

function setSlot(name){
  const slot=document.getElementById(name);
  slot.style.backgroundImage=`url(${BARS[name]})`;
  document.getElementById('val'+name).textContent=totals[name];
}
Object.keys(BARS).forEach(setSlot);

function animateSlot(statName, theme){
  const slot=document.getElementById(statName);
  if(!slot) return;
  const chev=document.createElement('img');
  chev.className='chev '+(theme==='down'?'animDown':'animUp');
  chev.src= theme==='down'?CHEV_DOWN:CHEV_UP;
  slot.appendChild(chev);
  const val=document.getElementById('val'+statName);
  val.classList.remove('pop'); void val.offsetWidth; val.classList.add('pop');
  setTimeout(()=>chev.remove(),1000);
}

if(animStat){
  const key=animStat.charAt(0).toUpperCase()+animStat.slice(1);
  animateSlot(key,theme);
}
</script>
</body>
</html>
